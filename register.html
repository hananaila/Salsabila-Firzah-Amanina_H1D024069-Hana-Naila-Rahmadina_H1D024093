<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daftar - PHARMEDICE</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="form-container">
        <form class="form-wrapper" id="registerForm">
            <h2 class="form-title">Daftar PHARMEDICE</h2>
            
            <div class="form-group">
                <label class="form-label" for="full_name">Nama Lengkap</label>
                <input type="text" class="form-input" id="full_name" name="full_name" required>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="email">Email</label>
                <input type="email" class="form-input" id="email" name="email" required>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="password">Password</label>
                <input type="password" class="form-input" id="password" name="password" required minlength="8">
                <div class="error-message">Password minimal 8 karakter</div>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="confirm_password">Konfirmasi Password</label>
                <input type="password" class="form-input" id="confirm_password" name="confirm_password" required>
                <div class="error-message">Konfirmasi password tidak sesuai</div>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="phone">Nomor Telepon</label>
                <input type="tel" class="form-input" id="phone" name="phone">
            </div>
            
            <div class="form-group">
                <label class="form-label" for="birth_date">Tanggal Lahir</label>
                <input type="date" class="form-input" id="birth_date" name="birth_date">
            </div>
            
            <div class="form-group">
                <label class="form-label" for="gender">Jenis Kelamin</label>
                <select class="form-select" id="gender" name="gender">
                    <option value="">Pilih Jenis Kelamin</option>
                    <option value="male">Laki-laki</option>
                    <option value="female">Perempuan</option>
                    <option value="other">Lainnya</option>
                </select>
            </div>
            
            <button type="submit" class="btn-submit">Daftar</button>
            
            <div class="form-links">
                <p>Sudah punya akun? <a href="login.html">Masuk di sini</a></p>
                <p><a href="index.html">Kembali ke Beranda</a></p>
            </div>
        </form>
    </div>

    <script src="js/validation.js"></script>
    <script>
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate password confirmation
            const password = document.getElementById('password');
            const confirmPassword = document.getElementById('confirm_password');
            
            if (password.value !== confirmPassword.value) {
                confirmPassword.classList.add('error');
                confirmPassword.nextElementSibling.style.display = 'block';
                return;
            }
            
            if (validateForm(this)) {
                const formData = new FormData(this);
                const data = Object.fromEntries(formData);
                
                fetch('api/register.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                })
                .then(response => response.json())
                .then(result => {
                    if (result.success) {
                        alert(result.message);
                        window.location.href = 'login.html';
                    } else {
                        alert('Registrasi gagal: ' + result.message);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Terjadi kesalahan saat registrasi');
                });
            }
        });

        // Real-time password confirmation check
        document.getElementById('confirm_password').addEventListener('input', function() {
            const password = document.getElementById('password').value;
            if (this.value && password !== this.value) {
                this.classList.add('error');
                this.nextElementSibling.style.display = 'block';
            } else {
                this.classList.remove('error');
                this.nextElementSibling.style.display = 'none';
            }
        });
    </script>
</body>
</html>